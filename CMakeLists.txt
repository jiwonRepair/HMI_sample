cmake_minimum_required(VERSION 3.16)

project(test4 VERSION 0.1 LANGUAGES CXX)

set(CMAKE_CXX_STANDARD_REQUIRED ON)

# âœ… Qt ë¼ì´ë¸ŒëŸ¬ë¦¬ ì°¾ê¸° (Gui, Qml, Quick ì¶”ê°€)
find_package(Qt6 REQUIRED COMPONENTS Gui Qml Quick Test)

qt_standard_project_setup(REQUIRES 6.5)

# âœ… QML íŒŒì¼ ë¦¬ìŠ¤íŠ¸
set(QML_FILES
    Main.qml
    Page2.qml
    Page3.qml
    Page4.qml
    Page5.qml
    CpuGauge.qml
    BatteryGauge.qml
    MemoryGauge.qml
    DiskGauge.qml
    WifiGauge.qml
    HWstatus.qml
    graph.qml
)

# âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ íŒŒì¼ ì¶”ê°€
qt_add_executable(apptest4
    main.cpp
    pagemanager.h pagemanager.cpp
    cpumonitor.h cpumonitor.cpp
    batterymonitor.h batterymonitor.cpp
    memorymonitor.h memorymonitor.cpp
    diskmonitor.h diskmonitor.cpp
    hardwarestatusmodel.h hardwarestatusmodel.cpp
    wifimonitor.h wifimonitor.cpp
)

# âœ… QML ëª¨ë“ˆ ì¶”ê°€
qt_add_qml_module(apptest4
    URI test4
    VERSION 1.0
    QML_FILES ${QML_FILES}
    QML_FILES
    SOURCES loggingdecorator.h loggingdecorator.cpp
    SOURCES appguard.h appguard.cpp
)

# âœ… Qt ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§í¬ ì¶”ê°€
target_link_libraries(apptest4 PRIVATE Qt6::Gui Qt6::Qml Qt6::Quick)

# âœ… Windows ì‹œìŠ¤í…œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ (ğŸš€ ì˜¤ë¥˜ í•´ê²°)
if(WIN32)
    target_link_libraries(apptest4 PRIVATE setupapi wlanapi)
endif()

# âœ… í…ŒìŠ¤íŠ¸ ì‹¤í–‰ íŒŒì¼ ì¶”ê°€ (í•„ìˆ˜ .cpp íŒŒì¼ í¬í•¨)
add_executable(tst_qmltest
    tst_qmltest.cpp
    uitest.cpp
    pagemanager.h pagemanager.cpp
    cpumonitor.h cpumonitor.cpp
    batterymonitor.h batterymonitor.cpp
    memorymonitor.h memorymonitor.cpp
    diskmonitor.h diskmonitor.cpp
    hardwarestatusmodel.h hardwarestatusmodel.cpp
    wifimonitor.h wifimonitor.cpp
    uitest.h
)

# âœ… í…ŒìŠ¤íŠ¸ ì‹¤í–‰ íŒŒì¼ì— Qt ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€
target_link_libraries(tst_qmltest PRIVATE Qt6::Gui Qt6::Qml Qt6::Quick Qt6::Test)

# âœ… Windows ì‹œìŠ¤í…œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€ (ğŸš€ ì˜¤ë¥˜ í•´ê²°)
if(WIN32)
    target_link_libraries(tst_qmltest PRIVATE setupapi wlanapi)
endif()

include(GNUInstallDirs)

install(TARGETS apptest4
    BUNDLE DESTINATION .
    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
    RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
)


# # âœ… CTest ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
# enable_testing()

# # âœ… í…ŒìŠ¤íŠ¸ ë“±ë¡
# add_test(NAME QmlTest COMMAND tst_qmltest)

# # âœ… í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œ í™˜ê²½ ë³€ìˆ˜ ì ìš© (QTEST_FUNCTION_TIMEOUT=0)
# set_tests_properties(QmlTest PROPERTIES
#     ENVIRONMENT "QTEST_FUNCTION_TIMEOUT=0"
# )
